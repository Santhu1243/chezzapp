{% extends "base.html" %}

{% block start %}
<div class="container mt-5">
    {% if user.is_authenticated %}
    <h1 class="text-center">Issue Details</h1>
    <table class="table table-bordered mt-4">
        <thead>
            <tr>
                <th scope="col">Field</th>
                <th scope="col">Details</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><strong>Issue Title</strong></td>
                <td>{{ issue.issue }}</td>
            </tr>
            <tr>
                <td><strong>Description</strong></td>
                <td>{{ issue.description }}</td>
            </tr>
            <tr>
                <td><strong>Reporter</strong></td>
                <td>{{ issue.reporter.username }}</td>
            </tr>
            <tr>
                <td><strong>Email</strong></td>
                <td>{{ issue.email }}</td>
            </tr>
            <tr>
                <td><strong>Date Reported</strong></td>
                <td>{{ issue.report_date }}</td>
            </tr>
            <tr>
                <td><strong>Time Reported</strong></td>
                <td>{{ issue.report_time }}</td>
            </tr>

            <!-- Display Attachments -->
            <tr>
                <td><strong>Attachments</strong></td>
                <td>
                    {% if issue.attachment %}
                    <a href="{{ issue.attachment.url }}" target="_blank">{{ issue.attachment.name }}</a>
                    {% else %}
                    <p>No attachments provided.</p>
                    {% endif %}
                </td>
            </tr>


            <tr>
                <td><strong>Root Cause</strong></td>
                <td>{{ issue.root_cause }}</td>
            </tr>
            <tr>
                <td><strong>Status</strong></td>
                <td>
                    {% if issue.status == 'open' %}
                    <span class="badge bg-success">Open</span>
                    {% elif issue.status == 'in_progress' %}
                    <span class="badge bg-warning">In Progress</span>
                    {% else %}
                    <span class="badge bg-danger">Resolved</span>
                    {% endif %}
                </td>
            </tr>
        </tbody>
    </table>
    <div class="text-center mt-4">
        <a href="{% url 'nonsap:home' %}" class="btn btn-secondary">Back to Issues</a>
    </div>
    {% else %}
    <div class="alert alert-danger mt-5">
        <h4 class="text-center">You do not have permission to view this page.</h4>
    </div>
    {% endif %}
</div>
{% endblock %}